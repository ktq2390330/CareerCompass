<!-- base.htmlを継承 -->
{% extends "filter_base.html" %}

<!-- staticタグを使うために追加 -->
{% load static %}

<!-- filter_area用のタイトル -->
{% block title %}filter area{% endblock %}

<!-- 埋め込む用のcssを読み込む -->
{% block head2 %}
    <link href="{% static 'css/filter_area.css' %}" rel="stylesheet">
{% endblock %}

<!-- pagekeyをぶち込む -->
{% block page_key %}filter_area{% endblock %}

<!-- filter_base.htmlにぶち込む部分 -->
{% block content2 %}
    <!-- 選択ボタンと詳細を横並びにするためのラッパー -->
    <div class="selection-wrapper">
        <!-- 大分類ボタン -->
        <nav class="selection">
            <ul class="selection-button">
                {% for area0 in area0_list %}
                <li>
                    <a href="javascript:void(0);" onclick="showArea('area{{ area0.id }}')">
                        {{ area0.name }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </nav>


        <div class="checkbox-field">
            <!-- 各エリアのチェックボックス -->
            {% for area0 in area0_list %}
            <!-- 初期表示したいエリアに 'active' クラスを追加 -->
            <div id="area{{ area0.id }}" class="area-details {% if forloop.first %}active{% endif %}">
                <button type="button" onclick="selectAll('area{{ area0.id }}', true)">すべて選択</button>
                <button type="button" onclick="selectAll('area{{ area0.id }}', false)">選択解除</button>
                
                {% for area1 in area1_list %}
                    {% if area1.area0_id == area0.id %}
                    <label>
                        <input type="checkbox" name="area[]" value="{{ area1.id }}"> {{ area1.name }}
                    </label><br>
                    {% endif %}
                {% endfor %}
            </div>
            {% endfor %}
        </div>
    </div>

    <script>
        // ページ読み込み時に最初のエリアを表示
        window.onload = function() {
            // 最初のエリアを表示
            const firstArea = document.querySelector('.area-details');
            if (firstArea) {
                firstArea.classList.add('active');
            }
    
            // 最初のボタンをアクティブにする
            const firstButton = document.querySelector('.selection-button a');
            if (firstButton) {
                firstButton.classList.add('active');
            }
        };
    
        // ボタンをクリックして対応するチェックボックスを表示
        function showArea(areaId) {
            // すべてのエリア詳細を非表示にする
            const allAreas = document.querySelectorAll('.area-details');
            allAreas.forEach(area => area.classList.remove('active'));
            
            // 該当するチェックボックスを表示
            const targetArea = document.getElementById(areaId);
            if (targetArea) {
                targetArea.classList.add('active');
            }
    
            // すべてのボタンから 'active' クラスを削除
            const allButtons = document.querySelectorAll('.selection-button a');
            allButtons.forEach(button => button.classList.remove('active'));
    
            // クリックしたボタンに 'active' クラスを追加
            const clickedButton = document.querySelector(`.selection-button a[onclick="showArea('${areaId}')"]`);
            if (clickedButton) {
                clickedButton.classList.add('active');
            }
        }
    
        // すべて選択/解除
        function selectAll(areaId, isChecked) {
            const checkboxes = document.querySelectorAll('#' + areaId + ' input[type="checkbox"]');
            checkboxes.forEach(checkbox => checkbox.checked = isChecked);
        }
    </script>     
{% endblock %}
