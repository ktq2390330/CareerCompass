<!-- base.htmlを継承 -->
{% extends "filter_base.html" %}

<!-- staticタグを使うために追加 -->
{% load static %}

<!-- filter_jobtype用のタイトル -->
{% block title %}filter jobtype{% endblock %}

<!-- 埋め込む用のcssを読み込む -->
{% block head2 %}
    <link href="{% static 'css/filter_jobtype.css' %}" rel="stylesheet">
{% endblock %}

<!-- filter_base.htmlにぶち込む部分 -->
{% block content2 %}
    <!-- 選択ボタンと詳細を横並びにするためのラッパー -->
    <div class="selection-wrapper">
        <!-- 大分類ボタン -->
        <nav class="selection">
            <ul class="selection-button">
                {% for category10 in category10_list %}
                <li>
                    <!-- 各ボタンに onclick で業界IDを渡す -->
                    <a href="javascript:void(0);" onclick="showJobtype('jobtype{{ category10.id }}')">
                        {{ category10.name }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </nav>

        <!-- 各業界のチェックボックス -->
        <div class="checkbox-field">
            {% for category10 in category10_list %}
            <!-- 初期表示する業界に 'active' クラスを追加 -->
            <div id="jobtype{{ category10.id }}" class="jobtype-details {% if forloop.first %}active{% endif %}">
                <button type="button" onclick="selectAll('jobtype{{ category10.id }}', true)">すべて選択</button>
                <button type="button" onclick="selectAll('jobtype{{ category10.id }}', false)">選択解除</button>
                
                <!-- category11 のチェックボックスを動的に生成 -->
                {% for category11 in category11_list %}
                    {% if category11.category10_id == category10.id %}
                    <label>
                        <input type="checkbox" name="jobtype[]" value="{{ category11.id }}"> {{ category11.name }}
                    </label><br>
                    {% endif %}
                {% endfor %}
            </div>
            {% endfor %}
        </div>
    </div>

    <script>
        // ページ読み込み時に最初の業界を表示
        window.onload = function() {
            const firstJobtype = document.querySelector('.jobtype-details');
            if (firstJobtype) {
                firstJobtype.classList.add('active');
            }
        };

        // 業界ボタンをクリックして対応するチェックボックスを表示
        function showJobtype(jobtypeId) {
            // すべての業界詳細を非表示にする
            const allJobtypes = document.querySelectorAll('.jobtype-details');
            allJobtypes.forEach(jobtype => jobtype.classList.remove('active'));
        
            // 該当する業界詳細を表示
            const targetJobtype = document.getElementById(jobtypeId);
            if (targetJobtype) {
                targetJobtype.classList.add('active');
            }
        }
        
        // すべて選択/解除
        function selectAll(jobtypeId, isChecked) {
            const checkboxes = document.querySelectorAll('#' + jobtypeId + ' input[type="checkbox"]');
            checkboxes.forEach(checkbox => checkbox.checked = isChecked);
        }
    </script>    
{% endblock %}
