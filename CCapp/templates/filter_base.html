{% extends "base.html" %}

{% load static %}

{% block title %}Filter Unified{% endblock %}

{% block head %}
<link href="{% static 'css/filter_base.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container">
    <div class="search-field">
        <form method="GET" action="{% url 'CCapp:offer_search' %}" id="filterForm">
            <input type="text" name="name" placeholder="企業名や業種で探す">
            <button type="button" onclick="submitCombinedForm()">検索</button>

            <!-- 大分類ボタン -->
            <nav class="filter-navigation">
                <ul class="filter-navigation-button">
                    <li><a href="javascript:void(0);" onclick="switchFilter('area')">エリア</a></li>
                    <li><a href="javascript:void(0);" onclick="switchFilter('industry')">業界</a></li>
                    <li><a href="javascript:void(0);" onclick="switchFilter('jobtype')">職種</a></li>
                    <li><a href="javascript:void(0);" onclick="switchFilter('benefits')">福利厚生</a></li>
                </ul>
            </nav>

            <div class="under_navigation-line"></div>

            <!-- 中分類 (エリアの地方ボタン) -->
            <nav class="area-navigation filter-section" id="area">
                <ul class="region-button">
                    {% for area in area0_list %}
                    <li>
                        <a href="javascript:void(0);" onclick="showSubcategories('area{{ area.id }}')">
                            {{ area.name }}
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </nav>

            <!-- 中分類 (業界のカテゴリボタン) -->
            <nav class="industry-navigation filter-section" id="industry">
                <ul class="industry-button">
                    {% for industry in category00_list %}
                    <li>
                        <a href="javascript:void(0);" onclick="showSubcategories('industry{{ industry.id }}')">
                            {{ industry.name }}
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </nav>

            <!-- 中分類 (職種のカテゴリボタン) -->
            <nav class="jobtype-navigation filter-section" id="jobtype">
                <ul class="jobtype-button">
                    {% for jobtype in category10_list %}
                    <li>
                        <a href="javascript:void(0);" onclick="showSubcategories('jobtype{{ jobtype.id }}')">
                            {{ jobtype.name }}
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </nav>

            <!-- 中分類 (福利厚生のタグボタン) -->
            <nav class="benefits-navigation filter-section" id="benefits">
                <ul class="benefits-button">
                    <li>
                        <a href="javascript:void(0);" onclick="showSubcategories('tag{{ tag.id }}')">
                            福利厚生
                        </a>
                    </li>
                </ul>
            </nav>

            <!-- 小分類 (チェックボックス) -->
            <div class="checkbox-field">
                {% for area in area0_list %}
                <div id="area{{ area.id }}" class="subcategory-section">
                    {% for region in area1_list %}
                    {% if region.area0_id == area.id %}
                    <div class="prefecture-checkboxes">
                        <label>
                            <input type="checkbox" name="area1" value="{{ region.id }}">
                            {{ region.name }}
                        </label><br>
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
                {% endfor %}

                {% for industry in category00_list %}
                <div id="industry{{ industry.id }}" class="subcategory-section">
                    {% for category in category01_list %}
                    {% if category.category00_id == industry.id %}
                    <div class="industry-checkboxes">
                        <label>
                            <input type="checkbox" name="category01" value="{{ category.id }}">
                            {{ category.name }}
                        </label><br>
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
                {% endfor %}

                {% for jobtype in category10_list %}
                <div id="jobtype{{ jobtype.id }}" class="subcategory-section">
                    {% for category in category11_list %}
                    {% if category.category10_id == jobtype.id %}
                    <div class="jobtype-checkboxes">
                        <label>
                            <input type="checkbox" name="category11" value="{{ category.id }}">
                            {{ category.name }}
                        </label><br>
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
                {% endfor %}

                {% for tag in tag_list %}
                <label>
                    <input type="checkbox" name="tag" value="{{ tag.id }}"> {{ tag.name }}
                </label><br>
                {% endfor %}
            </div>

            <button type="submit">検索</button>
        </form>
    </div>
</div>

<script>
    // 大分類の切り替え
    function switchFilter(filterType) {
        document.querySelectorAll('.filter-section').forEach(section => {
            section.style.display = 'none';
        });

        let selectedSection = document.getElementById(filterType);
        if (selectedSection) {
            selectedSection.style.display = 'block';
        }

        document.querySelectorAll('.subcategory-section').forEach(section => {
            section.style.display = 'none';
        });
    }

    // 中分類の選択時に該当するチェックボックスを表示
    function showSubcategories(subcategoryId) {
        document.querySelectorAll('.subcategory-section').forEach(section => {
            section.style.display = 'none';
        });

        let selectedSubcategory = document.getElementById(subcategoryId);
        if (selectedSubcategory) {
            selectedSubcategory.style.display = 'block';
        }
    }

    // ページロード時の初期化
    window.onload = function() {
        document.querySelectorAll('.filter-section').forEach(section => {
            section.style.display = 'none';
        });

        document.querySelectorAll('.subcategory-section').forEach(section => {
            section.style.display = 'none';
        });

        document.getElementById('area').style.display = 'block';
    };
</script>
{% endblock %}
