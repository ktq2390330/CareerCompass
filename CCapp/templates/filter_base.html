{% extends "base.html" %}

{% load static %}

{% block title %}Filter Unified{% endblock %}

{% block head %}
<link href="{% static 'css/filter_base.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container">
    <div class="search-field">
        <form method="GET" action="{% url 'CCapp:offer_search' %}" id="filterForm">
            <input type="text" name="name" placeholder="企業名や業種で探す">
            <button type="button" onclick="submitCombinedForm()">検索</button>

            <!-- ボタンナビゲーション -->
            <nav class="filter-navigation">
                <ul class="filter-navigation-button">
                    <li>
                        <a href="javascript:void(0);" onclick="switchFilter('area')">エリア</a>
                    </li>
                    <li>
                        <a href="javascript:void(0);" onclick="switchFilter('industry')">業界</a>
                    </li>
                    <li>
                        <a href="javascript:void(0);" onclick="switchFilter('jobtype')">職種</a>
                    </li>
                    <li>
                        <a href="javascript:void(0);" onclick="switchFilter('benefits')">福利厚生</a>
                    </li>
                </ul>
            </nav>

            <div class="under_navigation-line"></div>

            <!-- 動的チェックボックスエリア -->
            <div class="checkbox-field">
                <!-- エリア -->
                <div id="area" class="filter-section active">
                    {% for area0 in area0_list %}
                    <button type="button" onclick="selectAll('area{{ area0.id }}', true)">すべて選択</button>
                    <button type="button" onclick="selectAll('area{{ area0.id }}', false)">選択解除</button>
                    <div id="area{{ area0.id }}">
                        {% for area1 in area1_list %}
                        {% if area1.area0_id == area0.id %}
                        <label>
                            <input type="checkbox" name="area1" value="{{ area1.id }}">
                            {{ area1.name }}
                        </label><br>
                        {% endif %}
                        {% endfor %}
                    </div>
                    {% endfor %}
                </div>

                <!-- 業界 -->
                <div id="industry" class="filter-section">
                    {% for category00 in category00_list %}
                    <button type="button" onclick="selectAll('industry{{ category00.id }}', true)">すべて選択</button>
                    <button type="button" onclick="selectAll('industry{{ category00.id }}', false)">選択解除</button>
                    <div id="industry{{ category00.id }}">
                        {% for category01 in category01_list %}
                        {% if category01.category00_id == category00.id %}
                        <label>
                            <input type="checkbox" name="category01" value="{{ category01.id }}">
                            {{ category01.name }}
                        </label><br>
                        {% endif %}
                        {% endfor %}
                    </div>
                    {% endfor %}
                </div>
                <!-- 他の分類も同様に追加 -->
            </div>

            <button type="submit">検索</button>
        </form>
    </div>
</div>

<script>
    // フィルターの切り替え
    function switchFilter(filterType) {
        document.querySelectorAll('.filter-section').forEach(section => {
            section.classList.remove('active');
        });
        document.getElementById(filterType).classList.add('active');
    }

    // すべて選択または解除
    function selectAll(sectionId, isChecked) {
        document.querySelectorAll(`#${sectionId} input[type="checkbox"]`).forEach(checkbox => {
            checkbox.checked = isChecked;
        });
    }

    // ページロード時の初期化
    window.onload = function() {
        document.getElementById('area').classList.add('active');
    };
</script>
{% endblock %}
